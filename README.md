# イチベル
**流れるときにいないお前が悪い**
## 概要
ボカロ曲を布教したりされたり作業用BGMにしたり、回ったり叫んだり狂ったりできる神サイト、[KiiteCafe](https://cafe.kiite.jp)で好きな曲が流れる直前に通知するDiscordBotです。

## 使い方
[このリンク](https://discord.com/api/oauth2/authorize?client_id=932282973997375488&permissions=0&scope=applications.commands%20bot)からサーバーに導入することで使えます。  
イチベルが参加しているサーバーもしくはイチベルとのDMで下記のコマンドが使えるようになります。  
まずは`register`コマンドでKiiteのプレイリストを登録しましょう。リストに入っている曲がCafeで流れる約1分前に通知します。  
リストのどの曲が流れるかは分かりませんが、Cafeで流れ終わると確認できるようになります。  
Cafeの仕様上、通知が来てからCafeに入ってもハートやイチ推しマークは表示されません。  
botを動かしている環境（Glitch）の仕様上、およそ12時間おきに再起動が発生します。再起動の影響で通知した後曲名が表示されなかったり、また稀に通知し損ねる可能性があります。  

## コマンド一覧
| コマンド      | 概要                                                                                                                         |
| ------------- | ---------------------------------------------------------------------------------------------------------------------------- |
| `/now`        | 今のCafe内の状況を表示します。                                                                                               |
| `/register`   | `URL`オプションにKiiteのプレイリストのURL（`https://kiite.jp/playlist/〜`）を入れるとそのリストを通知対象として登録します。  |
| `/list`       | 今イチベルに登録しているプレイリストを確認します。                                                                           |
| `/update`     | 今登録しているプレイリストの情報と通知する場所を更新します。                                                                 |
| `/unregister` | プレイリストの登録を解除して通知をやめさせます。チャンネルの管理権限を持っていれば他の人を指定して解除させることもできます。 |

## 注意事項
- 選曲通知は最後に`register`、`update`を実行したチャンネルまたはDMで行われます。通知する場所を変えたい時は変更先のチャンネルやDMで`update`を実行してください。
- チャンネル内でコマンドを使ったとき、一部を除きコマンドの入力結果を他のユーザーが見ることはできません。
- 自分以外を対象とした`unregister`は他のユーザーからも見え、また対象のユーザーに通知を行います。
- チャンネル内での選曲通知はメンション機能を用いて行われるため、通常の通知が他のユーザーにも届いてしまいます。通知設定がメンションのみになっているサーバーか、少人数のサーバーもしくはDMでの使用を推奨します。
- Kiiteでリストの曲を追加、削除しても通知リストは勝手に更新されません。変更を反映させる時はリストの操作をしたあとで`update`を実行してください。
- 自前でプログラムを走らせる場合は`.env`ファイルを作り`TOKEN`でDiscordBotのトークンを指定してください。
