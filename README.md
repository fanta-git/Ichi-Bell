# イチベル
**流れるときにいないお前が悪い**
## 概要
ボカロ曲を布教したりされたり作業用BGMにしたり、回ったり叫んだり狂ったりできる神サイト、[KiiteCafe](https://cafe.kiite.jp)で好きな曲が流れる1分前に通知するDiscordBotです。  
登録したプレイリストのどの曲が流れるかは分かりませんが、Cafeで流れ終わると確認できるようになります。  
ちょいちょい止まります。その時は数分待ってみてください。  

## 使い方
1. [このリンク](https://discord.com/api/oauth2/authorize?client_id=932282973997375488&permissions=0&scope=applications.commands%20bot)からサーバーにイチベルを追加します。DMで使用する場合も、イチベルと共通のサーバーがある必要があります。
2. `register`コマンドでKiiteのプレイリストを登録します。
3. リストに入っている曲がCafeで流れる1分前にメンションで通知します。リストのどの曲が流れるかは分かりませんが、Cafeで流れ終わると確認できるようになります。

## コマンド一覧
| コマンド | 概要 |
| --- | --- |
| `/now` | 今のCafe内の状況を表示します。 |
| `/register` | `URL`オプションにKiiteのプレイリストのURL（`https://kiite.jp/playlist/〜`）を入れるとそのリストを通知対象として登録します。 |
| `/update` | 今登録しているプレイリストの情報と通知する場所を更新します。 |
| `/unregister` | プレイリストの登録を解除して通知をやめさせます。チャンネルの管理権限を持っていれば他の人を指定して解除させることもできます。 |
| `/list` | イチベルに登録しているプレイリストの詳細を確認できます。スマホから使用するときは`limit`オプションを5にすると良いです。`sort`オプションで曲の表示順も変えられます。 |
| `/timetable` | Cafeでの選曲履歴を表示します。`list`コマンドと同じく、`limit`オプションで1ページに表示する曲数を変更できます。 |

## 注意事項
- 選曲通知は最後に`register`、`update`を実行したチャンネルまたはDMで行われます。通知する場所を変えたい時は変更先のチャンネルやDMで`update`を実行してください。
- Cafeの仕様上、通知が来てからCafeに入ってもハートやイチ推しマークは表示されません。
- Kiiteでリストの曲を追加、削除しても通知リストは勝手に更新されません。変更を反映させる時はリストの操作をしたあとで`update`を実行してください。
- botを動かしている環境（Glitch）の都合上、半日おきくらいに再起動がかかり、再起動中は通知が行われません。またさまざまな要因で止まることがあります。お守り程度にご活用ください。
- チャンネル内でコマンドを使ったとき、一部を除きコマンドの入力結果を他のユーザーが見ることはできません。
- 自分以外を対象とした`unregister`は他のユーザーからも見え、また対象のユーザーに通知を行います。
- チャンネル内での選曲通知はメンション機能を用いて行われるため、通常の通知が他のユーザーにも届いてしまいます。通知設定がメンションのみになっているサーバーか、少人数のサーバーもしくはDMでの使用を推奨します。
